<div class="layout">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- SIDEBAR -->
  <div class="sidebar">

    <div class="sidebar-header">
      <h3>Consumable</h3>
    </div>

    <div class="sidebar-menu">

      <div class="menu-item" [ngClass]="{active: activeSection==='category'}" (click)="activeSection='category'">
        <span class="menu-icon">üìÇ</span>
        Category
      </div>

      <div class="menu-item" [ngClass]="{active: activeSection==='sub-category'}" (click)="activeSection='sub-category'">
        <span class="menu-icon">üóÉÔ∏è</span>
        Sub-Category
      </div>

      <div class="menu-item" [ngClass]="{active: activeSection==='supplier'}" (click)="activeSection='supplier'">
        <span class="menu-icon">üöö</span>
        Supplier
      </div>

      <div class="menu-item" [ngClass]="{active: activeSection==='manufacturer'}" (click)="activeSection='manufacturer'">
        <span class="menu-icon">üè≠</span>
        Manufacturer
      </div>

      <div class="menu-item" [ngClass]="{active: activeSection==='company'}" (click)="activeSection='company'">
        <span class="menu-icon">üè¢</span>
        Company
      </div>

    </div>

  </div>

  <!-- CONTENT AREA -->
  <div class="content">

    <div class="card">

      <!-- CARD HEADER -->
      <!-- CARD HEADER -->
      <div class="user-header shadow-sm mb-3">
        <div class="d-flex justify-content-between align-items-center flex-wrap">

          <!-- LEFT SIDE -->
          <div class="d-flex align-items-center">

            <div class="header-icon-box mx-3">
              <i class="bi" [ngClass]="getSectionIcon()"></i>
            </div>

            <div>
              <h4 class="mb-0 fw-bold">
                {{ activeSection | titlecase }} Management
              </h4>
              <small class="text-muted">
                Manage {{ activeSection | titlecase }} records and settings
              </small>
            </div>

          </div>

          <!-- RIGHT SIDE BUTTONS -->
          <div class="d-flex gap-2 mt-3 mt-md-0">

            <!-- CREATE BUTTON -->
            <button
              class="btn btn-primary shadow-sm"
              data-bs-toggle="modal"
              data-bs-target="#createModal"
              [disabled]="userRights.hardwareDepartment.electronicDevice.manage === 0">
              <i class="bi bi-plus-lg me-1"></i>
              Create
            </button>

            <!-- EXPORT BUTTON -->
            <button
              class="btn btn-outline-primary shadow-sm" (click)="exportToExcel()"
              [disabled]="userRights.hardwareDepartment.electronicDevice.manage === 0">
              <i class="bi bi-download me-1"></i>
              Export
            </button>

          </div>

        </div>
      </div>

      <!-- SEARCH -->
      <div class="search-wrapper">
        <input type="text" [(ngModel)]="searchText" placeholder="Search..." />
      </div>

      <!-- TABLE -->
      <div class="table-scroll-wrapper">
        <table class="custom-table">

          <!-- ================= CATEGORY ================= -->
          <thead class="custom-table-head" *ngIf="activeSection==='category'">
            <tr>
              <th class="text-center" style="width:40px;">
                <div class="form-check m-0 d-flex justify-content-center">
                  <input class="form-check-input custom-checkbox"
                    type="checkbox"
                    [checked]="selectAll"
                    (change)="toggleSelectAll($event)">
                </div>
              </th>
              <th>#</th>
              <th>Name</th>
              <th class="text-center">Action</th>
            </tr>
          </thead>

          <tbody *ngIf="activeSection==='category'">
            <tr *ngFor="let category of filteredData; let i=index">
              <td class="text-center">
                <div class="form-check m-0 d-flex justify-content-center">
                  <input class="form-check-input custom-checkbox"
                    type="checkbox"
                    [checked]="selectedRows.includes(category)"
                    (change)="toggleRowSelection(category, $event)">
                </div>
              </td>
              <td>{{i+1}}</td>
              <td>{{category.name}}</td>
              <td class="text-center">
                <button class="btn btn-submit" data-bs-toggle="modal" data-bs-target="#editModal" [ngClass]="{disabled: userRights.ITDepartment.ITInventory.manage === 0}" (click)="editCategory(category)">
                  Edit
                </button>
              </td>
            </tr>
          </tbody>

          <!-- ================= SUB-CATEGORY ================= -->
          <thead class="custom-table-head" *ngIf="activeSection==='sub-category'">
            <tr>
              <th class="text-center" style="width:40px;">
                <div class="form-check m-0 d-flex justify-content-center">
                  <input class="form-check-input custom-checkbox"
                    type="checkbox"
                    [checked]="selectAll"
                    (change)="toggleSelectAll($event)">
                </div>
              </th>
              <th>#</th>
              <th>Category Name</th>
              <th>Sub-Category</th>
              <th>Prefix</th>
              <th>Numeric Digit</th>
              <th>Suffix</th>
              <!-- <th>Others</th> -->
              <th class="text-center">Action</th>
            </tr>
          </thead>

          <tbody *ngIf="activeSection==='sub-category'">
            <tr *ngFor="let subCategory of filteredData; let i=index">
              <td class="text-center">
                <div class="form-check m-0 d-flex justify-content-center">
                  <input class="form-check-input custom-checkbox"
                    type="checkbox"
                    [checked]="selectedRows.includes(subCategory)"
                    (change)="toggleRowSelection(subCategory, $event)">
                </div>
              </td>
              <td>{{ i+1 }}</td>
              <td>{{ subCategory.categoryName?.name }}</td>
              <td>{{ subCategory.subCategoryName }}</td>
              <td>{{ subCategory.prefix }}</td>
              <td>{{ subCategory.numbericDigit }}</td>
              <td>{{ subCategory.suffix }}</td>
              <!-- <td>
                {{ getSelectedFieldCount(subCategory.fields) }} Selected
              </td> -->
              <td class="text-center">
                <button class="btn btn-submit" data-bs-toggle="modal" data-bs-target="#createModal" [ngClass]="{disabled: userRights.ITDepartment.ITInventory.manage === 0}" (click)="editSubCategory(subCategory)">
                  Edit
                </button>
              </td>

            </tr>
          </tbody>

          <!-- ================= SUPPLIER ================= -->
          <thead class="custom-table-head" *ngIf="activeSection==='supplier'">
            <tr>
              <th class="text-center" style="width:40px;">
                <div class="form-check m-0 d-flex justify-content-center">
                  <input class="form-check-input custom-checkbox"
                    type="checkbox"
                    [checked]="selectAll"
                    (change)="toggleSelectAll($event)">
                </div>
              </th>
              <th>#</th>
              <th>Name</th>
              <th>Contact</th>
              <th>Email</th>
              <th>Address</th>
              <th>Type</th>
              <th class="text-center">Action</th>
            </tr>
          </thead>

          <tbody *ngIf="activeSection==='supplier'">
            <tr *ngFor="let supplier of filteredData; let i=index">
              <td class="text-center">
                <div class="form-check m-0 d-flex justify-content-center">
                  <input class="form-check-input custom-checkbox"
                    type="checkbox"
                    [checked]="selectedRows.includes(supplier)"
                    (change)="toggleRowSelection(supplier, $event)">
                </div>
              </td>
              <td>{{i+1}}</td>
              <td>{{supplier.supplierName}}</td>
              <td>{{supplier.contact}}</td>
              <td>{{supplier.email}}</td>
              <td>{{supplier.address}}</td>
              <td>{{supplier.type}}</td>
              <td class="text-center">
                <button class="btn btn-submit" data-bs-toggle="modal" data-bs-target="#editModal" [ngClass]="{disabled: userRights.ITDepartment.ITInventory.manage === 0}" (click)="editSupplier(supplier)">
                  Edit
                </button>
              </td>
            </tr>
          </tbody>

          <!-- ================= MANUFACTURER ================= -->
          <thead class="custom-table-head" *ngIf="activeSection==='manufacturer'">
            <tr>
              <th class="text-center" style="width:40px;">
                <div class="form-check m-0 d-flex justify-content-center">
                  <input class="form-check-input custom-checkbox"
                    type="checkbox"
                    [checked]="selectAll"
                    (change)="toggleSelectAll($event)">
                </div>
              </th>
              <th>#</th>
              <th>Name</th>
              <th class="text-center">Action</th>
            </tr>
          </thead>

          <tbody *ngIf="activeSection==='manufacturer'">
            <tr *ngFor="let manufacturer of filteredData; let i=index">
              <td class="text-center">
                <div class="form-check m-0 d-flex justify-content-center">
                  <input class="form-check-input custom-checkbox"
                    type="checkbox"
                    [checked]="selectedRows.includes(manufacturer)"
                    (change)="toggleRowSelection(manufacturer, $event)">
                </div>
              </td>
              <td>{{i+1}}</td>
              <td>{{manufacturer.name}}</td>
              <td class="text-center">
                <button class="btn btn-submit" data-bs-toggle="modal" data-bs-target="#editModal" [ngClass]="{disabled: userRights.ITDepartment.ITInventory.manage === 0}" (click)="editManufacturer(manufacturer)">
                  Edit
                </button>
              </td>
            </tr>
          </tbody>

          <!-- ================= COMPANY ================= -->
          <thead class="custom-table-head" *ngIf="activeSection==='company'">
            <tr>
              <th class="text-center" style="width:40px;">
                <div class="form-check m-0 d-flex justify-content-center">
                  <input class="form-check-input custom-checkbox"
                    type="checkbox"
                    [checked]="selectAll"
                    (change)="toggleSelectAll($event)">
                </div>
              </th>
              <th scope="col" class="align-middle background-dark">#</th>
              <th scope="col" class="align-middle background-dark">Company Name</th>
              <th scope="col" class="align-middle background-dark">Abbreviation</th>
              <th scope="col" class="align-middle background-dark">GST Number</th>
              <th scope="col" class="align-middle background-dark">Address</th>
              <th scope="col" colspan="2" class="align-middle background-dark">Action</th>
            </tr>
          </thead>

          <tbody *ngIf="activeSection==='company'">
            <tr *ngFor="let company of filteredData; let i=index">
              <td class="text-center">
                <div class="form-check m-0 d-flex justify-content-center">
                  <input class="form-check-input custom-checkbox"
                    type="checkbox"
                    [checked]="selectedRows.includes(company)"
                    (change)="toggleRowSelection(company, $event)">
                </div>
              </td>
              <td>{{i+1}}</td>
              <td>{{company.companyName}}</td>
              <td>{{company.abbreviation}}</td>
              <td>{{company.GSTNumber}}</td>
              <td>{{company.address}}</td>
              <td class="text-center">
                <button class="btn btn-submit" data-bs-toggle="modal" data-bs-target="#editModal" [ngClass]="{disabled: userRights.ITDepartment.ITInventory.manage === 0}" (click)="editCompany(company)"> Edit </button>
              </td>
            </tr>
          </tbody>

        </table>

        <div *ngIf="filteredData.length === 0">
          <span colspan="10" class="text-center no-data-row">
            No data found for "{{ searchText }}"
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- UNIVERSAL CREATE MODAL -->
  <div class="modal fade" id="createModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">

    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">

        <div class="modal-header">
          <h5 class="modal-title">
            Create {{activeSection | titlecase}}
          </h5>
          <button type="button" class="btn-close" id="createModalCloseBtn" data-bs-dismiss="modal"> </button>
        </div>

        <div class="modal-body">

          <!-- Category -->
          <form *ngIf="activeSection==='category'" [formGroup]="createCategoryForm" (ngSubmit)="submitCategory()">
            <div class="row">

              <div class="col-12 mb-3">
                <label> Name <span class="required">*</span></label>
                <input type="text" class="form-control" formControlName="name" (blur)="checkITCategoryname()">

                <small
                  *ngIf="createCategoryForm.controls['name'].errors?.['required'] && createCategoryForm.controls['name'].touched" class="error-message">
                  This field is required
                </small>
                <small
                  *ngIf="createCategoryForm.controls['name']?.errors?.['maxlength'] && createCategoryForm.controls['name']?.touched" class="error-message">
                  Name cannot exceed 30 characters.
                </small>
                <small
                  *ngIf="createCategoryForm.controls['name'].errors?.['notUnique'] && createCategoryForm.controls['name'].touched" class="error-message">
                  Name already exists !
                </small>
              </div>

            </div>

            <div class="text-end">
              <button type="submit" class="btn btn-submit" [disabled]="createCategoryForm.invalid">
                Save
              </button>
            </div>
          </form>

          <!-- Sub-Category -->
          <form *ngIf="activeSection==='sub-category'" [formGroup]="createSubCategoryForm" (ngSubmit)="onSubCategorySubmit()">
            <div class="row g-3">

              <!-- Category -->
              <div class="col-md-6">
                <label class="form-label fw-semibold">
                  Category <span class="text-danger">*</span>
                </label>

                <select class="form-select" formControlName="categoryName">
                  <option *ngFor="let category of inCategoriesList" [value]="category._id">
                    {{ category.name }}
                  </option>
                </select>

                <small class="text-danger"
                  *ngIf="createSubCategoryForm.get('categoryName')?.hasError('required') && createSubCategoryForm.get('categoryName')?.touched">
                  This field is required.
                </small>
              </div>

              <!-- Sub-category -->
              <div class="col-md-6">
                <label class="form-label fw-semibold">
                  Sub-category <span class="text-danger">*</span>
                </label>

                <input type="text" class="form-control" formControlName="subCategoryName" (blur)="checkSubCategoryName()" />

                <small class="text-danger"
                  *ngIf="createSubCategoryForm.get('subCategoryName')?.hasError('required') && createSubCategoryForm.get('subCategoryName')?.touched">
                  This field is required.
                </small>

                <small class="text-danger"
                  *ngIf="createSubCategoryForm.get('subCategoryName')?.hasError('notUnique')">
                  Sub-category name already exists!
                </small>
              </div>

              <!-- Prefix -->
              <div class="col-md-4">
                <label class="form-label fw-semibold">
                  Prefix <span class="text-danger">*</span>
                </label>

                <input type="text" class="form-control" formControlName="prefix" />

                <small class="text-danger"
                  *ngIf="createSubCategoryForm.get('prefix')?.hasError('required') && createSubCategoryForm.get('prefix')?.touched">
                  This field is required.
                </small>
              </div>

              <!-- Numeric Digit -->
              <div class="col-md-4">
                <label class="form-label fw-semibold">
                  Numeric Digit <span class="text-danger">*</span>
                </label>

                <input type="number" class="form-control" formControlName="numbericDigit" min="3" />

                <small class="text-danger"
                  *ngIf="createSubCategoryForm.get('numbericDigit')?.hasError('required') && createSubCategoryForm.get('numbericDigit')?.touched">
                  This field is required.
                </small>
              </div>

              <!-- Suffix -->
              <div class="col-md-4">
                <label class="form-label fw-semibold">
                  Suffix <span class="text-danger">*</span>
                </label>

                <input type="text" class="form-control" formControlName="suffix" />

                <small class="text-danger"
                  *ngIf="createSubCategoryForm.get('suffix')?.hasError('required') && createSubCategoryForm.get('suffix')?.touched">
                  This field is required.
                </small>

                <small class="text-danger"
                  *ngIf="createSubCategoryForm.get('suffix')?.hasError('alreadyExists')">
                  Suffix already exists.
                </small>
              </div>

            </div>

            <!-- Checkbox Section -->
            <div class="mt-4">
              <h6 class="fw-semibold mb-3">
                Please select the fields you want to include:
              </h6>

              <!-- Select All -->
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="selectAll" formControlName="checkedAll" (change)="toggleAllCheckboxes($event)" />

                <label for="selectAll" class="form-check-label fw-semibold">
                  Select All
                </label>
              </div>

              <!-- Checkboxes Grid -->
              <div formGroupName="checkboxes" class="row g-2">
                <div class="col-md-4 col-sm-6"
                  *ngFor="let key of Object.keys(createSubCategoryForm.get('checkboxes')?.value)">

                  <div class="form-check">
                    <input type="checkbox" class="form-check-input" [id]="key" [formControlName]="key" (change)="onCheckboxChange()" />

                    <label class="form-check-label" [for]="key">
                      {{ checkboxLabels[key] }}
                    </label>
                  </div>

                </div>
              </div>

              <!-- Error -->
              <div *ngIf="createSubCategoryForm.get('checkboxes')?.hasError('atLeastOneRequired')" class="text-danger mt-2">
                Please select at least one option.
              </div>

            </div>

            <!-- Submit -->
            <div class="d-flex justify-content-center mt-4">
              <button type="submit" class="btn btn-primary px-4" [disabled]="createSubCategoryForm.invalid || loading">
                {{ loading ? 'Submitting...' : mode === 'create' ? 'Create' : 'Update' }}
              </button>
            </div>

          </form>

          <!-- Supplier -->
          <form *ngIf="activeSection==='supplier'" [formGroup]="createSupplierForm" (ngSubmit)="submitSupplier()">
            <div class="row">

              <div class="col-6 mb-3">
                <label>Supplier Name <span class="required">*</span></label>
                <input type="text" class="form-control" formControlName="supplierName">

                <small
                  *ngIf="createSupplierForm.controls['supplierName'].errors?.['required'] && createSupplierForm.controls['supplierName'].touched" class="error-message">
                  This field is required
                </small>
                <small
                  *ngIf="createSupplierForm.controls['supplierName']?.errors?.['maxlength'] && createSupplierForm.controls['supplierName']?.touched" class="error-message">
                  Name cannot exceed 30 characters.
                </small>
                <small
                  *ngIf="createSupplierForm.controls['supplierName'].errors?.['notUnique'] && createSupplierForm.controls['supplierName'].touched" class="error-message">
                  Name already exists !
                </small>
              </div>

              <div class="col-6 mb-3">
                <label>Contact </label>
                <input type="text" class="form-control" formControlName="contact">

                <div
                  *ngIf="createSupplierForm.controls['contact'].touched && (createSupplierForm.controls['contact'].invalid && createSupplierForm.controls['contact'].errors?.['pattern'])" class="error-message">
                  Please Enter a valid phone number
                </div>
              </div>

              <div class="col-6 mb-3">
                <label>Email</label>
                <input type="text" class="form-control" formControlName="email">

                <div
                  *ngIf="createSupplierForm.controls['email'].invalid && createSupplierForm.controls['email'].touched" class="error-message">
                  Please enter a valid email address.
                </div>
              </div>

              <div class="col-6 mb-3">
                <label>Address</label>
                <input type="text" class="form-control" formControlName="address">
              </div>

              <div class="col-6 mb-3">
                <label>Type </label>
                <select class="form-select" formControlName="type">
                  <option value="Local">Local</option>
                  <option value="Imported">Imported</option>
                </select>
              </div>

            </div>

            <div class="text-end">
              <button type="submit" class="btn btn-submit" [disabled]="createSupplierForm.invalid">
                Save
              </button>
            </div>
          </form>

          <!-- Manufacturer -->
          <form *ngIf="activeSection==='manufacturer'" [formGroup]="createManufacturerForm" (ngSubmit)="submitManufacturer()">

            <label>Manufacturer Name <span class="required">*</span></label>
            <input type="text" class="form-control" formControlName="manufacturerName">

            <small
              *ngIf="createManufacturerForm.controls['manufacturerName'].errors?.['required'] && createManufacturerForm.controls['manufacturerName'].touched" class="error-message">This
              field is required
            </small>
            <small
              *ngIf="createManufacturerForm.controls['manufacturerName']?.errors?.['maxlength'] && createManufacturerForm.controls['manufacturerName']?.touched" class="error-message">
              Name cannot exceed 30 characters.
            </small>
            <small
              *ngIf="createManufacturerForm.controls['manufacturerName'].errors?.['notUnique'] && createManufacturerForm.controls['manufacturerName'].touched" class="error-message">
              Name already exists !
            </small>

            <div class="text-end mt-3">
              <button type="submit" class="btn btn-submit" [disabled]="createManufacturerForm.invalid">
                Save
              </button>
            </div>
          </form>

          <!-- Company -->
          <form *ngIf="activeSection==='company'" [formGroup]="createCompanyForm" (ngSubmit)="submitCompany()">
            <div class="row">

              <div class="col-6 mb-3">
                <label>Company Name <span class="required">*</span></label>
                <input type="text" class="form-control" formControlName="companyName">

                <small class="error-message" *ngIf="createCompanyForm.controls['companyName'].errors?.['required'] && createCompanyForm.controls['companyName'].touched">This field is Required</small>
                <small class="error-message" *ngIf="createCompanyForm.controls['companyName'].errors?.['notUnique']">Company name is already exist!</small>
              </div>

              <div class="col-6 mb-3">
                <label>Abbreviation <span class="required">*</span></label>
                <input type="text" class="form-control" formControlName="abbreviation">

                <small class="error-message" *ngIf="createCompanyForm.controls['abbreviation'].errors?.['required'] && createCompanyForm.controls['abbreviation'].touched">This field is Required</small>
                <small class="error-message" *ngIf="createCompanyForm.controls['abbreviation'].errors?.['notUnique']">Company Abbreviation is already exist!</small>
              </div>

              <div class="col-6 mb-3">
                <label>GST Number</label>
                <input type="text" class="form-control" formControlName="GSTNumber">

                <!-- <small class="error-message" *ngIf="createCompanyForm.controls['GSTNumber'].errors?.['required'] && createCompanyForm.controls['GSTNumber'].touched">This field is Required</small> -->
                <!-- <small class="error-message" *ngIf="createCompanyForm.controls['GSTNumber'].errors?.['notUnique']">Company name is already exist!</small> -->
              </div>

              <div class="col-6 mb-3">
                <label>Address</label>
                <input type="text" class="form-control" formControlName="address">

                <!-- <small class="error-message" *ngIf="createCompanyForm.controls['address'].errors?.['required'] && createCompanyForm.controls['address'].touched">This field is Required</small> -->
                <!-- <small class="error-message" *ngIf="createCompanyForm.controls['address'].errors?.['notUnique']">Company name is already exist!</small> -->
              </div>

            </div>

            <div class="text-end">
              <button type="submit" class="btn btn-submit" [disabled]="createCompanyForm.invalid">
                Save
              </button>
            </div>
          </form>

        </div>
      </div>
    </div>
  </div>

<!-- UNIVERSAL EDIT MODAL -->
<div class="modal modal-sm fade" id="editModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">

  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">
          Edit {{activeSection | titlecase}}
        </h5>
        <button type="button" class="btn-close" id="editModalCloseBtn" data-bs-dismiss="modal"> </button>
      </div>

      <div class="modal-body">
        <!-- Category -->
        <form *ngIf="activeSection === 'category'" [formGroup]="editCategoryForm" (ngSubmit)="submitEditCategory()">
          <div class="row">

            <div class="col-12 mb-3">
              <label>Category Name <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="name" (blur)="checkEditCategoryName()">

              <small
                *ngIf="editCategoryForm.controls['name'].errors?.['required'] && editCategoryForm.controls['name'].touched" class="error-message">
                This field is required
              </small>
              <small
                *ngIf="editCategoryForm.controls['name']?.errors?.['maxlength'] && editCategoryForm.controls['name']?.touched" class="error-message">
                Name cannot exceed 30 characters.
              </small>
              <small
                *ngIf="editCategoryForm.controls['name'].errors?.['notUnique'] && editCategoryForm.controls['name'].touched" class="error-message">
                Name already exists !
              </small>
            </div>

          </div>

          <div class="text-end mt-3">
            <button type="submit" class="btn btn-submit" [disabled]="editCategoryForm.invalid">
              Update
            </button>
          </div>
        </form>

        <!-- Sub-Category need to change-->
        <form *ngIf="activeSection === 'sub-category'" [formGroup]="createSubCategoryForm" (ngSubmit)="onSubCategorySubmit()">
          <div class="row g-3">

            <!-- Category -->
            <div class="col-md-6">
              <label class="form-label fw-semibold">
                Category <span class="text-danger">*</span>
              </label>

              <select class="form-select" formControlName="categoryName">
                <option *ngFor="let category of inCategoriesList" [value]="category._id">
                  {{ category.name }}
                </option>
              </select>

              <small class="text-danger"
                *ngIf="createSubCategoryForm.get('categoryName')?.hasError('required') && createSubCategoryForm.get('categoryName')?.touched">
                This field is required.
              </small>
            </div>

            <!-- Sub-category -->
            <div class="col-md-6">
              <label class="form-label fw-semibold">
                Sub-category <span class="text-danger">*</span>
              </label>

              <input type="text" class="form-control" formControlName="subCategoryName" (blur)="checkSubCategoryName()" />

              <small class="text-danger"
                *ngIf="createSubCategoryForm.get('subCategoryName')?.hasError('required') && createSubCategoryForm.get('subCategoryName')?.touched">
                This field is required.
              </small>

              <small class="text-danger"
                *ngIf="createSubCategoryForm.get('subCategoryName')?.hasError('notUnique')">
                Sub-category name already exists!
              </small>
            </div>

            <!-- Prefix -->
            <div class="col-md-4">
              <label class="form-label fw-semibold">
                Prefix <span class="text-danger">*</span>
              </label>

              <input type="text" class="form-control" formControlName="prefix" />

              <small class="text-danger"
                *ngIf="createSubCategoryForm.get('prefix')?.hasError('required') && createSubCategoryForm.get('prefix')?.touched">
                This field is required.
              </small>
            </div>

            <!-- Numeric Digit -->
            <div class="col-md-4">
              <label class="form-label fw-semibold">
                Numeric Digit <span class="text-danger">*</span>
              </label>

              <input type="number" class="form-control" formControlName="numbericDigit" min="3" />

              <small class="text-danger"
                *ngIf="createSubCategoryForm.get('numbericDigit')?.hasError('required') && createSubCategoryForm.get('numbericDigit')?.touched">
                This field is required.
              </small>
            </div>

            <!-- Suffix -->
            <div class="col-md-4">
              <label class="form-label fw-semibold">
                Suffix <span class="text-danger">*</span>
              </label>

              <input type="text" class="form-control" formControlName="suffix" />

              <small class="text-danger"
                *ngIf="createSubCategoryForm.get('suffix')?.hasError('required') && createSubCategoryForm.get('suffix')?.touched">
                This field is required.
              </small>

              <small class="text-danger"
                *ngIf="createSubCategoryForm.get('suffix')?.hasError('alreadyExists')">
                Suffix already exists.
              </small>
            </div>

          </div>

          <!-- Checkbox Section -->
          <div class="mt-4">
            <h6 class="fw-semibold mb-3">
              Please select the fields you want to include:
            </h6>

            <!-- Select All -->
            <div class="form-check mb-2">
              <input type="checkbox" class="form-check-input" id="selectAll" formControlName="checkedAll" (change)="toggleAllCheckboxes($event)" />

              <label for="selectAll" class="form-check-label fw-semibold">
                Select All
              </label>
            </div>

            <!-- Checkboxes Grid -->
            <div formGroupName="checkboxes" class="row g-2">
              <div class="col-md-4 col-sm-6"
                *ngFor="let key of Object.keys(createSubCategoryForm.get('checkboxes')?.value)">

                <div class="form-check">
                  <input type="checkbox" class="form-check-input" [id]="key" [formControlName]="key" (change)="onCheckboxChange()" />

                  <label class="form-check-label" [for]="key">
                    {{ checkboxLabels[key] }}
                  </label>
                </div>

              </div>
            </div>

            <!-- Error -->
            <div *ngIf="createSubCategoryForm.get('checkboxes')?.hasError('atLeastOneRequired')" class="text-danger mt-2">
              Please select at least one option.
            </div>

          </div>

          <!-- Submit -->
          <div class="d-flex justify-content-center mt-4">
            <button type="submit" class="btn btn-primary px-4" [disabled]="createSubCategoryForm.invalid || loading">
              {{ loading ? 'Submitting...' : mode === 'create' ? 'Create' : 'Update' }}
            </button>
          </div>

        </form>

        <!-- Supplier -->
        <form *ngIf="activeSection === 'supplier'" [formGroup]="editSupplierForm" (ngSubmit)="submitEditSupplier()">
          <div class="row">

            <div class="col-6 mb-3">
              <label>Supplier Name <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="supplierName" (blur)="checkEditSupplierName()">

              <small
                *ngIf="editSupplierForm.controls['supplierName'].errors?.['required'] && editSupplierForm.controls['supplierName'].touched" class="error-message">
                This field is required
              </small>
              <small
                *ngIf="editSupplierForm.controls['supplierName']?.errors?.['maxlength'] && editSupplierForm.controls['supplierName']?.touched" class="error-message">
                Name cannot exceed 30 characters.
              </small>
              <small
                *ngIf="editSupplierForm.controls['supplierName'].errors?.['notUnique'] && editSupplierForm.controls['supplierName'].touched" class="error-message">
                Name already exists !
              </small>
            </div>

            <div class="col-6 mb-3">
              <label>Contact</label>
              <input type="text" class="form-control" formControlName="contact">

              <div
                *ngIf="editSupplierForm.controls['contact'].touched && (editSupplierForm.controls['contact'].invalid && editSupplierForm.controls['contact'].errors?.['pattern'])" class="error-message">
                Please Enter a valid phone number
              </div>
            </div>

            <div class="col-6 mb-3">
              <label>Email</label>
              <input type="text" class="form-control" formControlName="email">

              <div
                *ngIf="editSupplierForm.controls['email'].invalid && editSupplierForm.controls['email'].touched" class="error-message">
                Please enter a valid email address.
              </div>
            </div>

            <div class="col-6 mb-3">
              <label>Address</label>
              <input type="text" class="form-control" formControlName="address">
            </div>

            <div class="col-6 mb-3">
              <label>Type <span class="required">*</span> </label>
              <select class="form-select" formControlName="type">
                <option value="Local">Local</option>
                <option value="Imported">Imported</option>
              </select>

              <small
                *ngIf="editSupplierForm.controls['type'].errors?.['required'] && editSupplierForm.controls['type'].touched" class="error-message">
                This field is required
              </small>
            </div>

          </div>

          <div class="text-end mt-3">
            <button type="submit" class="btn btn-submit" [disabled]="editSupplierForm.invalid">
              Update
            </button>
          </div>
        </form>

        <!-- Manufacturer -->
        <form *ngIf="activeSection === 'manufacturer'" [formGroup]="editManufacturerForm" (ngSubmit)="submitEditManufacturer()">

          <label>Manufacturer Name <span class="required">*</span></label>
          <input type="text" class="form-control" formControlName="manufacturerName" (blur)="checkEditManufacturer()">

          <small class="error-message"
            *ngIf="editManufacturerForm.controls['manufacturerName'].errors?.['required'] && editManufacturerForm.controls['manufacturerName'].touched">
            This field is required
          </small>
          <small
            *ngIf="editManufacturerForm.controls['manufacturerName']?.errors?.['maxlength'] && editManufacturerForm.controls['manufacturerName']?.touched" class="error-message">
            Name cannot exceed 30 characters.
          </small>
          <small class="error-message"
            *ngIf="editManufacturerForm.controls['manufacturerName'].errors?.['notUnique'] && editManufacturerForm.controls['manufacturerName'].touched">
            Name already exists!
          </small>

          <div class="text-end mt-3">
            <button type="submit" class="btn btn-submit" [disabled]="editManufacturerForm.invalid">
              Update
            </button>
          </div>
        </form>

        <!-- Company -->
        <form *ngIf="activeSection==='company'" [formGroup]="editCompanyForm" (ngSubmit)="submitEditCompany()">
          <div class="row">

            <div class="col-6 mb-3">
              <label>Company Name <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="companyName">

              <small class="error-message"
                *ngIf="editCompanyForm.controls['companyName'].errors?.['required'] && editCompanyForm.controls['companyName'].touched">
                This field is Required
              </small>
              <small class="error-message"
                *ngIf="editCompanyForm.controls['companyName'].errors?.['notUnique']">
                Company name is already exist!
              </small>
            </div>

            <div class="col-6 mb-3">
              <label>Abbreviation <span class="required">*</span></label>
              <input type="text" class="form-control" formControlName="abbreviation">

              <small class="error-message"
                *ngIf="editCompanyForm.controls['abbreviation'].errors?.['required'] && editCompanyForm.controls['abbreviation'].touched">
                  This field is Required
                </small>
              <small class="error-message"
                *ngIf="editCompanyForm.controls['abbreviation'].errors?.['notUnique']">
                Company Abbreviation is already exist!
              </small>
            </div>

            <div class="col-6 mb-3">
              <label>GST Number</label>
              <input type="text" class="form-control" formControlName="GSTNumber">

              <!-- <small class="error-message" *ngIf="createCompanyForm.controls['GSTNumber'].errors?.['required'] && createCompanyForm.controls['GSTNumber'].touched">This field is Required</small> -->
              <!-- <small class="error-message" *ngIf="createCompanyForm.controls['GSTNumber'].errors?.['notUnique']">Company name is already exist!</small> -->
            </div>

            <div class="col-6 mb-3">
              <label>Address</label>
              <input type="text" class="form-control" formControlName="address">

              <!-- <small class="error-message" *ngIf="createCompanyForm.controls['address'].errors?.['required'] && createCompanyForm.controls['address'].touched">This field is Required</small> -->
              <!-- <small class="error-message" *ngIf="createCompanyForm.controls['address'].errors?.['notUnique']">Company name is already exist!</small> -->
            </div>

          </div>

          <div class="text-end mt-3">
            <button type="submit" class="btn btn-submit" [disabled]="editCompanyForm.invalid">
              Update
            </button>
          </div>
        </form>

      </div>
    </div>
  </div>
</div>
